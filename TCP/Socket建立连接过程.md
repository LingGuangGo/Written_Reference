### Socket 套接字

1. Socket 套接字
   - 支持TCP/IP协议的网络通信的基本操作单元,
   - 中间软件抽象层，它是一组接口
   - 在设计模式中，Socket其实就是一个门面模式, 它把复杂的TCP/IP协议族隐藏在Socket接口后面
2. Socket网络通信要求：
   + 连接协议(TCP/UDP)，
   + 本地主机IP，本地进程的协议端口，
   + 远地主机IP，远地进程的协议端口。
3. 建立socket连接
   - 需要一对套接字: 一个运行于客户端，称为ClientSocket ，另一个运行于服务器端，称为ServerSocket
   - 套接字之间的连接过程分为三个步骤：服务器监听，客户端请求，连接确认
     - 服务器监听：服务器端套接字, 等待客户端的连接请求。
     - 客户端请求: 客户端描述连接的服务器的套接字，指出服务器端套接字的地址和端口号
     - 连接确认: server建立一个新的**线程**，把服务器端套接字的描述发给客户端，一旦客户端确认了此描述，双方就正式建立连接
   - 服务器端套接字继续处于监听状态，继续接收其他客户端套接字的连接请求

### socket连接建立过程

1. socket通讯的基本过程（基于TCP协议）

   （1）服务器端建立一个Socket，

   （2）服务器端通过bind()绑定Socket端口,并通过调用listen()对端口进行监听；

   （3）服务器端Socket通过调用accept()方法，使之处于阻塞，等待客户端连接。

   （4）客户端创建一个Socket,并设置好服务器的IP和端口。

   （5）客户端调用connect()发送连接请求，建立连接。

   （6）建立连接后服务器和客户端通过send(),recv()进行发送和接收操作

   （7）通信结束后服务器和客户端都通过调用close()将套接字关闭。

2. 基于UDP协议

   （1）服务端建立socket，

   （2）服务端通过bind()进行绑定到本地地址和端口

   （3）服务器端调用recvfrom()进行等待接收数据

   （4）客户端建立socket，调用sendto()向服务器

   （5）完成数据传输后，close()关闭套接字