## Linux内存管理中mmap的原理？

1. 问题一：如何将mmap后读写映射区域和普通的read/write联系起来？
   + 普通的read/write和mmap后的映射区域的读写到底有什么区别
   + 为什么有时候会选择mmap而放弃普通的read/write

### page chache 页缓存的原理

1. 在真正的把用户数据读写到磁盘或者是存储设备前
   + 内核还会在page cache中管理这些数据。
   + page的存在有效的管理了用户数据和读写的效率
2. 用户数据不是直接来自于应用层，读(read)或者是写入(write)磁盘和存储介质；
   + 被一层一层的应用所划分，在每一层次中都会有不同的功能对应
   + 最后发生交互时，在最恰当的时机**触发磁盘**的操作
3. IO驱动写入磁盘和存储介质
   + page的管理设计到了缓存，这些缓存以page的单位管理
   + 在没有IO操作之前，暂时存放在系统空间中，而并未直接写入磁盘或者存贮介质。

### 系统调用中的mmap 和read/write关系

1. mmap的执行，仅仅是在内核中建立了文件与虚拟内存空间的对应关系。用户访问这些虚拟内存空间时，页面表里面是没有这些空间的表项的。
2. 当用户程序试图访问这些映射的空间时，于是产生**缺页异常**。内核捕捉这些异常，逐渐将文件载入。
3. 所谓的**载入过程**，具体的操作就是read和write在管理pagecache。

### [效率对比](https://blog.csdn.net/edwardlulinux/article/details/8604400)

1. 看出使用mmap后发现，系统调用所消耗的时间远远比普通的read少很多。